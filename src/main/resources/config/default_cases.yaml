testCases:
    - scenarioId: "A1"
      classfication: "Summary"
      description: ""
      sql: |
          SELECT
              TUMBLE_END(ts, INTERVAL '1' HOUR) AS calculation_time,
              AVG(fuel_consumption) AS avg_fuel_consumption
          FROM
              readings
          GROUP BY
              TUMBLE(ts, INTERVAL '1' HOUR)

    - scenarioId: "A2"
      classfication: "Summary"
      description: ""
      sql: |
          SELECT
              window_end AS calculation_time,
              COUNT(*) AS vehicle_count,
              AVG(cur_fuel_consumption) AS avg_fuel_consumption
          FROM (
              SELECT
                  name,
                  TUMBLE_END(ts, INTERVAL '1' MINUTE) AS window_end,
                  LAST_VALUE(fuel_consumption) AS cur_fuel_consumption,
                  LAST_VALUE(grade) AS cur_grade
              FROM readings
              GROUP BY 
                  name,
                  TUMBLE(ts, INTERVAL '1' MINUTE)
          ) 
          WHERE cur_grade > 70
          GROUP BY window_end;

    - scenarioId: "A3"
      classfication: "Summary"
      description: ""
      sql: |
          SELECT
              window_end AS calculation_time,
              COUNT(*) AS vehicle_count,
              AVG(avg_fuel) AS avg_fuel_consumption
          FROM (
              SELECT
                  name,
                  TUMBLE_END(ts, INTERVAL '1' MINUTE) AS window_end,
                  LAST_VALUE(elevation) AS last_elevation,
                  AVG(fuel_consumption) AS avg_fuel
              FROM readings
              GROUP BY 
                  TUMBLE(ts, INTERVAL '1' MINUTE),
                  name
          ) 
          WHERE last_elevation > 1000
          GROUP BY window_end;

    - scenarioId: "A4"
      classfication: "Summary"
      description: ""
      sql: |
          SELECT
                window_end AS calculation_time,
                SUM(last_load) AS total_load
            FROM (
                SELECT
                    name,
                    TUMBLE_END(ts, INTERVAL '10' MINUTE) AS window_end,
                    LAST_VALUE(current_load) AS last_load
                FROM diagnostics
                GROUP BY
                    TUMBLE(ts, INTERVAL '10' MINUTE),
                    name
            )
            GROUP BY window_end;

    - scenarioId: "A5"
      classfication: "Summary"
      description: ""
      sql: |
          SELECT
              window_end AS calculation_time,
              direction,
              COUNT(*) AS vehicle_count
          FROM (
              SELECT
                  name,
                  window_end,
                  CASE
                      WHEN last_heading < 45 OR last_heading >= 315 THEN 0
                      WHEN last_heading >= 45 AND last_heading < 135 THEN 90
                      WHEN last_heading >= 135 AND last_heading < 225 THEN 180
                      ELSE 270
                  END AS direction
              FROM (
                  SELECT
                      name,
                      TUMBLE_END(ts, INTERVAL '10' MINUTE) AS window_end,
                      LAST_VALUE(heading) AS last_heading
                  FROM readings
                  GROUP BY
                      TUMBLE(ts, INTERVAL '10' MINUTE),
                      name
              )
          )
          GROUP BY
              window_end,
              direction;

    - scenarioId: "A6"
      classfication: "Summary"
      description: ""
      sql: |
          SELECT
              window_end AS calculation_time,
              COUNT(*) AS vehicle_count,
              AVG(last_velocity) AS avg_velocity
          FROM (
              SELECT
                  a.window_end,
                  b.last_velocity
              FROM (
                  SELECT
                      name,
                      TUMBLE_END(ts, INTERVAL '1' HOUR) AS window_end,
                      LAST_VALUE(current_load) AS last_load,
                      LAST_VALUE(load_capacity) AS last_load_capacity
                  FROM diagnostics
                  WHERE current_load IS NOT NULL 
                      AND load_capacity IS NOT NULL
                  GROUP BY
                      TUMBLE(ts, INTERVAL '1' HOUR),
                      name
              ) a
              JOIN (
                  SELECT
                      name,
                      TUMBLE_END(ts, INTERVAL '1' HOUR) AS window_end,
                      LAST_VALUE(velocity) AS last_velocity
                  FROM readings
                  WHERE velocity IS NOT NULL
                  GROUP BY
                      TUMBLE(ts, INTERVAL '1' HOUR),
                      name
              ) b
              ON a.name = b.name AND a.window_end = b.window_end
              WHERE a.last_load < 0.1 * a.last_load_capacity
          )
          GROUP BY window_end;

    - scenarioId: "A7"
      classfication: "Summary"
      description: ""
      sql: |
          SELECT
              TUMBLE_START(ts, INTERVAL '1' DAY) AS calculation_time,
              AVG(fuel_consumption) AS avg_fuel_consumption
          FROM readings
          GROUP BY TUMBLE(ts, INTERVAL '1' DAY);

    - scenarioId: "A8"
      classfication: "Summary"
      description: ""
      sql: |
          SELECT
              TUMBLE_START(fault_end, INTERVAL '1' DAY) AS calculation_time,
              SUM(TIMESTAMPDIFF(SECOND, fault_start, fault_end)) / 3600.0 AS total_fault_hours
          FROM (
              SELECT
                  ts,
                  name,
                  CASE 
                      WHEN status > 0 THEN 1
                      ELSE 0
                  END AS fault_state
              FROM diagnostics
          )
          MATCH_RECOGNIZE (
              PARTITION BY name
              ORDER BY ts
              MEASURES
                  FIRST(S.ts) AS fault_start,
                  LAST(E.ts) AS fault_end,
                  COUNT(S.ts) AS data_points,
                  S.fault_state AS fault_state
              ONE ROW PER MATCH
              AFTER MATCH SKIP PAST LAST ROW
              PATTERN (S+ E)
              DEFINE
                  S AS (S.fault_state = 1),
                  E AS (E.fault_state = 0)
          )
          GROUP BY TUMBLE(fault_end, INTERVAL '1' DAY);

    - scenarioId: "A9"
      classfication: "Summary"
      description: ""
      sql: |
          SELECT
              window_start AS calculation_time,
              COUNT(*) AS vehicle_count
          FROM (
              SELECT
                  name,
                  TUMBLE_START(fault_end, INTERVAL '1' DAY) AS window_start,
                  SUM(TIMESTAMPDIFF(SECOND, fault_start, fault_end)) / 3600.0 AS total_fault_hours
              FROM (
                  SELECT
                      ts,
                      name,
                      CASE 
                          WHEN status > 0 THEN 1
                          ELSE 0
                      END AS fault_state
                  FROM diagnostics
              )
              MATCH_RECOGNIZE (
                  PARTITION BY name
                  ORDER BY ts
                  MEASURES
                      FIRST(S.ts) AS fault_start,
                      LAST(E.ts) AS fault_end,
                      COUNT(S.ts) AS data_points,
                      S.fault_state AS fault_state
                  ONE ROW PER MATCH
                  AFTER MATCH SKIP PAST LAST ROW
                  PATTERN (S+ E)
                  DEFINE
                      S AS (S.fault_state = 1),
                      E AS (E.fault_state = 0)
              )
              GROUP BY
                  name,
                  TUMBLE(fault_end, INTERVAL '1' DAY)
          )
          WHERE total_fault_hours > 12.0
          GROUP BY window_start;

    - scenarioId: "F1"
      classfication: "Fleet"
      description: ""
      sql: |
          SELECT
              window_start,
              window_end,
              fleet,
              COUNT(DISTINCT name) AS moving_trucks_count
          FROM TABLE(
              TUMBLE(TABLE readings, DESCRIPTOR(ts), INTERVAL '1' MINUTE)
          )
          WHERE velocity > 0 
          GROUP BY window_start, window_end, fleet;

    - scenarioId: "F2"
      classfication: "Fleet"
      description: ""
      sql: |
          SELECT
              window_start,
              window_end,
              fleet,
              COUNT(DISTINCT name) AS faulty_trucks_count
          FROM TABLE(
              TUMBLE(TABLE diagnostics, DESCRIPTOR(ts), INTERVAL '1' MINUTE)
          )
          GROUP BY window_start, window_end, fleet;

    - scenarioId: "F3"
      classfication: "Fleet"
      description: ""
      sql: |
          SELECT
              TUMBLE_START(ts, INTERVAL '1' HOUR) AS window_start,
              TUMBLE_END(ts, INTERVAL '1' HOUR) AS window_end,
              fleet,
              AVG(fuel_consumption) AS avg_fuel_consumption,
              COUNT(*) AS data_points
          FROM readings
          GROUP BY 
              TUMBLE(ts, INTERVAL '1' HOUR),
              fleet;

    - scenarioId: "F4"
      classfication: "Fleet"
      description: ""
      sql: |
          WITH avg_fuel_per_fleet AS (
              SELECT 
                  window_start,
                  window_end,
                  fleet,
                  AVG(fuel_consumption) AS avg_fuel
              FROM TABLE(
                  TUMBLE(TABLE readings, DESCRIPTOR(ts), INTERVAL '1' DAY)
              )
              WHERE fuel_consumption IS NOT NULL
              GROUP BY window_start, window_end, fleet
          ),
          avg_load_per_fleet AS (
              SELECT 
                  window_start,
                  window_end,
                  fleet,
                  AVG(current_load) AS avg_load
              FROM TABLE(
                  TUMBLE(TABLE diagnostics, DESCRIPTOR(ts), INTERVAL '1' DAY)
              )
              WHERE current_load IS NOT NULL
              GROUP BY window_start, window_end, fleet
          )
          SELECT 
              a.window_start AS ts,
              a.fleet,
              CASE 
                  WHEN a.avg_fuel > 0 THEN b.avg_load / a.avg_fuel
                  ELSE 0 
              END AS efficiency,
              a.avg_fuel,
              b.avg_load
          FROM avg_fuel_per_fleet a
          JOIN avg_load_per_fleet b ON 
              a.window_start = b.window_start 
              AND a.fleet = b.fleet;

    - scenarioId: "F5"
      classfication: "Fleet"
      description: ""
      sql: |
          SELECT
              fleet,
              TUMBLE_END(fault_end, INTERVAL '1' DAY) AS calculation_time,
              SUM(TIMESTAMPDIFF(SECOND, fault_start, fault_end)) AS total_fault_time_seconds
          FROM
          (
              SELECT
                  fleet,
                  name,
                  fault_state,
                  fault_start,
                  fault_end,
                  TIMESTAMPDIFF(SECOND, fault_start, fault_end) AS fault_duration,
                  data_points
              FROM
              (
                  SELECT
                      ts,
                      name,
                      fleet,
                      CASE 
                          WHEN status > 0 THEN 1
                          ELSE 0
                      END AS fault_state
                  FROM diagnostics
              )
              MATCH_RECOGNIZE
              (
                  PARTITION BY name
                  ORDER BY ts
                  MEASURES
                      FIRST(S.ts) AS fault_start,
                      LAST(E.ts) AS fault_end,
                      COUNT(S.ts) AS data_points,
                      S.fault_state AS fault_state,
                      S.fleet AS fleet
                  ONE ROW PER MATCH
                  AFTER MATCH SKIP PAST LAST ROW
                  PATTERN (S+ E)
                  DEFINE
                      S AS (S.fault_state = 1),
                      E AS (E.fault_state = 0)
              )
          )
          GROUP BY
              fleet,
              TUMBLE(fault_end, INTERVAL '1' DAY);

    - scenarioId: "F6"
      classfication: "Fleet"
      description: ""
      sql: |
          SELECT
              name,
              fleet,
              load_capacity,
              last_value(current_load) last_current_load,
              window_end
          FROM
          (
              SELECT
                  name,
                  fleet,
                  load_capacity,
                  current_load,
                  ts,
                  window_start,
                  window_end
              FROM TABLE(TUMBLE(TABLE diagnostics, DESCRIPTOR(ts), INTERVAL '1' HOUR))
              WHERE current_load IS NOT NULL 
              AND load_capacity IS NOT NULL
              AND load_capacity > 0
          ) GROUP BY name, fleet, load_capacity, window_end

    - scenarioId: "F7"
      classfication: "Fleet"
      description: ""
      sql: |
          SELECT
              fleet,
              window_end,
              CASE 
                  WHEN COUNT(*) > 0 THEN SUM(breakdown) / COUNT(*) 
                  ELSE 0 
              END AS fault_ratio,
              COUNT(*) AS total_trucks, 
              SUM(breakdown) AS faulty_trucks
          FROM (
              SELECT
                  name,
                  fleet,
                  CASE 
                      WHEN LAST_VALUE(status) > 0 THEN 1 
                      ELSE 0 
                  END AS breakdown,
                  window_end
              FROM (
                  SELECT
                      name,
                      fleet,
                      status,
                      ts,
                      window_start,
                      window_end
                  FROM TABLE(TUMBLE(TABLE diagnostics, DESCRIPTOR(ts), INTERVAL '1' HOUR))
                  WHERE status IS NOT NULL 
              )
              GROUP BY name, fleet, window_end
          )
          GROUP BY fleet, window_end

    - scenarioId: "F8"
      classfication: "Fleet"
      description: ""
      sql: |
          SELECT
              name,
              fleet,
              avg_fuel_consumption,
              window_end,
              rank_num
          FROM (
              SELECT
                  name,
                  fleet,
                  avg_fuel_consumption,
                  window_end,
                  ROW_NUMBER() OVER (
                      PARTITION BY fleet, window_end
                      ORDER BY avg_fuel_consumption DESC
                  ) AS rank_num
              FROM (
                  SELECT
                      name,
                      fleet,
                      AVG(fuel_consumption) AS avg_fuel_consumption,
                      window_end
                  FROM (
                      SELECT
                          ts,
                          name,
                          fleet,
                          fuel_consumption,
                          window_start,
                          window_end
                      FROM TABLE(TUMBLE(TABLE readings, DESCRIPTOR(ts), INTERVAL '1' DAY))
                      WHERE fuel_consumption IS NOT NULL 
                  )
                  GROUP BY name, fleet, window_end
              )
          )
          WHERE rank_num <= 5

    - scenarioId: "T1"
      classfication: "Vehicle"
      description: ""
      sql: |
          SELECT
              name,
              TUMBLE_END(ts, INTERVAL '1' HOUR) AS calculation_time,
              AVG(fuel_consumption) AS avg_fuel_consumption
          FROM readings
          GROUP BY
              name,
              TUMBLE(ts, INTERVAL '1' HOUR);

    - scenarioId: "T2"
      classfication: "Vehicle"
      description: ""
      sql: |
          SELECT
              name,
              TUMBLE_END(stop_end, INTERVAL '1' HOUR) AS calculation_time,
              SUM(TIMESTAMPDIFF(SECOND, stop_start, stop_end)) AS total_stop_time_seconds
          FROM (
              SELECT
                  ts,
                  name,
                  CASE 
                      WHEN velocity = 0 THEN 1
                      ELSE 0
                  END AS stop_state
              FROM readings
          )
          MATCH_RECOGNIZE (
              PARTITION BY name
              ORDER BY ts
              MEASURES
                  FIRST(S.ts) AS stop_start,
                  LAST(E.ts) AS stop_end,
                  COUNT(S.ts) AS data_points,
                  S.stop_state AS stop_state
              ONE ROW PER MATCH
              AFTER MATCH SKIP PAST LAST ROW
              PATTERN (S+ E)
              DEFINE
                  S AS (S.stop_state = 1),
                  E AS (E.stop_state = 0)
          )
          GROUP BY name, TUMBLE(stop_end, INTERVAL '1' HOUR);

    - scenarioId: "T3"
      classfication: "Vehicle"
      description: ""
      sql: |
          SELECT
              name,
              slope_interval,
              (sum_s_fuel + sum_c_fuel)  / (count_s + count_c) AS avg_fuel_consumption,
              (sum_s_velocity + sum_c_velocity) / (count_s + count_c) AS avg_velocity,
              segment_start,
              segment_end,
              (count_s + count_c) AS data_points
          FROM (
              SELECT
                  name,
                  ts,
                  fuel_consumption,
                  velocity,
                  grade,
                  CASE 
                      WHEN grade <= 30 THEN 0
                      WHEN grade <= 70 THEN 1
                      ELSE 2
                  END AS slope_interval
              FROM readings
          )
          MATCH_RECOGNIZE (
              PARTITION BY name
              ORDER BY ts
              MEASURES
                  FIRST(S.ts) AS segment_start,
                  LAST(E.ts) AS segment_end,
                  SUM(S.fuel_consumption) AS sum_s_fuel,
                  SUM(C.fuel_consumption) AS sum_c_fuel,
                  SUM(S.velocity) AS sum_s_velocity,
                  SUM(C.velocity) AS sum_c_velocity,
                  COUNT(S.ts) AS count_s,
                  COUNT(C.ts) AS count_c,
                  S.slope_interval AS slope_interval
              ONE ROW PER MATCH
              AFTER MATCH SKIP TO LAST E
              PATTERN (S C* E)
              DEFINE
                  S AS (S.slope_interval IS NOT NULL),
                  C AS (C.slope_interval = S.slope_interval),
                  E AS (E.slope_interval <> S.slope_interval OR E.slope_interval IS NULL)
          );

    - scenarioId: "T4"
      classfication: "Vehicle"
      description: ""
      sql: |
          SELECT
              name,
              velocity_interval,
              (sum_s_fuel + sum_c_fuel) / (count_s + count_c) AS avg_fuel_consumption,
              (sum_s_velocity + sum_c_velocity) / (count_s + count_c) AS avg_velocity,
              segment_start,
              segment_end,
              (count_s + count_c) AS data_points
          FROM (
              SELECT
                  name,
                  ts,
                  fuel_consumption,
                  velocity,
                  CASE 
                      WHEN velocity <= 30 THEN 0
                      WHEN velocity <= 70 THEN 1
                      ELSE 2
                  END AS velocity_interval
              FROM readings
          )
          MATCH_RECOGNIZE (
              PARTITION BY name
              ORDER BY ts
              MEASURES
                  FIRST(S.ts) AS segment_start,
                  LAST(E.ts) AS segment_end,
                  SUM(S.fuel_consumption) AS sum_s_fuel,
                  SUM(C.fuel_consumption) AS sum_c_fuel,
                  SUM(S.velocity) AS sum_s_velocity,
                  SUM(C.velocity) AS sum_c_velocity,
                  COUNT(S.ts) AS count_s,
                  COUNT(C.ts) AS count_c,
                  S.velocity_interval AS velocity_interval
              ONE ROW PER MATCH
              AFTER MATCH SKIP TO LAST E
              PATTERN (S C* E)
              DEFINE
                  S AS (S.velocity_interval IS NOT NULL),
                  C AS (C.velocity_interval = S.velocity_interval),
                  E AS (E.velocity_interval <> S.velocity_interval OR E.velocity_interval IS NULL)
          );

    - scenarioId: "T5"
      classfication: "Vehicle"
      description: ""
      sql: |
          SELECT
              name,
              fault_state,
              segment_start,
              segment_end,
              avg_s_current_load as avg_current_load,
              count_s AS data_points
          FROM (
              SELECT
                  name,
                  ts,
                  current_load,
                  CASE 
                      WHEN status > 0 THEN 1
                      ELSE 0
                  END AS fault_state
              FROM diagnostics
          )
          MATCH_RECOGNIZE (
              PARTITION BY name
              ORDER BY ts
              MEASURES
                  FIRST(S.ts) AS segment_start,
                  LAST(S.ts) AS segment_end,
                  AVG(S.current_load) AS avg_s_current_load,
                  COUNT(S.ts) AS count_s,
                  S.fault_state AS fault_state
              ONE ROW PER MATCH
              AFTER MATCH SKIP TO LAST E
              PATTERN (S+ E)
              DEFINE
                  S AS (S.fault_state = 1),
                  E AS (E.fault_state <> S.fault_state)
          );

    - scenarioId: "T6"
      classfication: "Vehicle"
      description: ""
      sql: |
          SELECT
              segment_start,
              segment_end,
              TIMESTAMPDIFF(SECOND, segment_start, segment_end) as segment_duration,
              name,
              low_fuel_state,
              avg_fuel_state,
              data_points
          FROM (
              SELECT
                  ts,
                  name,
                  fuel_state,
                  fuel_capacity,
                  CASE 
                      WHEN fuel_state < 0.2 * fuel_capacity THEN 1
                      ELSE 0
                  END AS low_fuel_state
              FROM diagnostics
              WHERE fuel_capacity <> 0
          )
          MATCH_RECOGNIZE (
              PARTITION BY name
              ORDER BY ts
              MEASURES
                  FIRST(S.ts) AS segment_start,
                  LAST(E.ts) AS segment_end,
                  AVG(S.fuel_state / S.fuel_capacity) AS avg_fuel_state,
                  COUNT(S.ts) AS data_points,
                  S.low_fuel_state AS low_fuel_state
              ONE ROW PER MATCH
              AFTER MATCH SKIP TO LAST E
              PATTERN (S+ E)
              DEFINE
                  S AS (S.low_fuel_state = 1),
                  E AS (E.low_fuel_state = 0)
          );

    - scenarioId: "T7"
      classfication: "Vehicle"
      description: ""
      sql: |
          SELECT
              segment_start,
              segment_end,
              TIMESTAMPDIFF(SECOND, segment_start, segment_end) as segment_duration,
              name,
              fuel_consumption_severity,
              avg_velocity,
              avg_grade,
              avg_elevation,
              avg_load,
              data_points
          FROM (
              SELECT
                  ts,
                  name,
                  velocity,
                  grade,
                  elevation,
                  fuel_consumption,
                  nominal_fuel_consumption,
                  CASE 
                      WHEN fuel_consumption > 2 * nominal_fuel_consumption THEN 1
                      ELSE 0
                  END AS fuel_consumption_severity
              FROM readings
          )
          MATCH_RECOGNIZE (
              PARTITION BY name
              ORDER BY ts
              MEASURES
                  FIRST(S.ts) AS segment_start,
                  LAST(E.ts) AS segment_end,
                  AVG(S.velocity) AS avg_velocity,
                  AVG(S.grade) AS avg_grade,
                  AVG(S.elevation) AS avg_elevation,
                  COUNT(S.ts) AS data_points,
                  S.fuel_consumption_severity AS fuel_consumption_severity
              ONE ROW PER MATCH
              AFTER MATCH SKIP TO LAST E  
              PATTERN (S+ E)
              DEFINE
                  S AS (S.fuel_consumption_severity = 1),
                  E AS (E.fuel_consumption_severity = 0) 
          ) AS match_result
          JOIN LATERAL (
              SELECT AVG(current_load) AS avg_load
              FROM diagnostics
              WHERE diagnostics.name = match_result.name 
              AND diagnostics.ts >= match_result.segment_start 
              AND diagnostics.ts <= match_result.segment_end
          ) AS load_stats ON TRUE;

    - scenarioId: "T8"
      classfication: "Vehicle"
      description: ""
      sql: |
          SELECT
              segment_start,
              segment_end,
              TIMESTAMPDIFF(SECOND, segment_start, segment_end) AS duration_seconds,
              name,
              high_speed_high_grade_state
              avg_fuel_consumption,
              data_points
          FROM (
              SELECT
                  ts,
                  name,
                  velocity,
                  grade,
                  fuel_consumption,
                  CASE 
                      WHEN velocity > 70 AND grade > 70 THEN 1
                      ELSE 0
                  END AS high_speed_high_grade_state
              FROM readings
          )
          MATCH_RECOGNIZE (
              PARTITION BY name
              ORDER BY ts
              MEASURES
                  FIRST(S.ts) AS segment_start,
                  LAST(E.ts) AS segment_end,
                  AVG(S.fuel_consumption) AS avg_fuel_consumption,
                  COUNT(S.ts) AS data_points,
                  S.high_speed_high_grade_state as high_speed_high_grade_state
              ONE ROW PER MATCH
              AFTER MATCH SKIP PAST LAST ROW
              PATTERN (S+ E)
              DEFINE
                  S AS (S.high_speed_high_grade_state = 1),
                  E AS (E.high_speed_high_grade_state = 0)
          );

    - scenarioId: "T9"
      classfication: "Vehicle"
      description: ""
      sql: |
          SELECT
              segment_start,
              segment_end,
              TIMESTAMPDIFF(SECOND, segment_start, segment_end) AS duration_seconds,
              name,
              full_tank_state
              first_current_load,
              data_points
          FROM (
              SELECT
                  ts,
                  name,
                  fuel_state,
                  current_load,
                  CASE 
                      WHEN fuel_state = 1 THEN 1
                      ELSE 0
                  END AS full_tank_state
              FROM diagnostics
          )
          MATCH_RECOGNIZE (
              PARTITION BY name
              ORDER BY ts
              MEASURES
                  FIRST(S.ts) AS segment_start,
                  LAST(E.ts) AS segment_end,
                  FIRST(S.current_load) AS first_current_load,
                  COUNT(S.ts) AS data_points,
                  S.full_tank_state as full_tank_state
              ONE ROW PER MATCH
              AFTER MATCH SKIP TO LAST E
              PATTERN (S+ E)
              DEFINE
                  S AS (S.full_tank_state = 1),
                  E AS (E.full_tank_state = 0)
          );
